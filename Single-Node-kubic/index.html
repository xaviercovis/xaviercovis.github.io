<!DOCTYPE html><html lang="en-US"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --><title>Single-node cluster Kubernetes with openSUSE Kubic and MetalLB | XCO</title><meta name="generator" content="Jekyll v3.8.7" /><meta property="og:title" content="Single-node cluster Kubernetes with openSUSE Kubic and MetalLB" /><meta name="author" content="GitHub User" /><meta property="og:locale" content="en_US" /><meta name="description" content="Table of Contents Introduccion" /><meta property="og:description" content="Table of Contents Introduccion" /><meta property="og:site_name" content="XCO" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-07-19T00:00:00-05:00" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"GitHub User"},"headline":"Single-node cluster Kubernetes with openSUSE Kubic and MetalLB","dateModified":"2020-07-19T00:00:00-05:00","datePublished":"2020-07-19T00:00:00-05:00","description":"Table of Contents Introduccion","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"/Single-Node-kubic/"},"url":"/Single-Node-kubic/","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/icons/apple-touch-icon.png?v=qA3OXqyw77"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/icons/favicon-32x32.png?v=qA3OXqyw77"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/icons/favicon-16x16.png?v=qA3OXqyw77"><link rel="manifest" href="/assets/img/icons/manifest.json?v=qA3OXqyw77"><link rel="mask-icon" href="/assets/img/icons/safari-pinned-tab.svg?v=qA3OXqyw77" color="#5bbad5"> <!--[if IE]><link rel="shortcut icon" href="/assets/img/icons/favicon.ico?v=qA3OXqyw77"><![endif]--><link rel="shortcut icon" href="/assets/img/icons/favicon.ico?v=qA3OXqyw77"><meta name="apple-mobile-web-app-title" content="XCO"><meta name="application-name" content="XCO"><meta name="msapplication-config" content="/assets/img/icons/browserconfig.xml?v=qA3OXqyw77"><meta name="theme-color" content="#ffffff"><style class="inlineCSS"> h1{color:#313237;margin-top:0;margin-bottom:.5rem}.dark-bg{background-color:#313237}@media only screen and (min-width:48em){.post-card{width:48.4375%;margin-right:3.125%}.post-card:last-of-type,.post-card:nth-child(2n+2){margin-right:0}}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figure,main{display:block}figure{margin:1em 40px}a{background-color:transparent;-webkit-text-decoration-skip:objects}img{border-style:none}svg:not(:root){overflow:hidden}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}body{-webkit-overflow-scrolling:touch}*,::after,::before{-webkit-box-sizing:inherit;box-sizing:inherit}.site{display:-webkit-box;display:-ms-flexbox;display:flex;min-height:100vh;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.site__content{-webkit-box-flex:1;-ms-flex:1;flex:1}img{max-width:100%;height:auto;width:auto;vertical-align:middle}figure{margin:0}body{background-color:#fff;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Hiragino Sans GB","Microsoft YaHei","WenQuanYi Micro Hei",sans-serif;font-size:1rem;line-height:1.5;color:#343851;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%}p{margin-top:0;margin-bottom:1.25rem}h1,h2{color:#313237;margin-top:0;margin-bottom:.5rem}a{color:#277cea;text-decoration:none;border-bottom:1px dashed #277cea}.blur{background:#fff;filter:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg"><filter id="filter"><feGaussianBlur stdDeviation="16" /></filter></svg>#filter');-webkit-filter:blur(1rem);filter:blur(1rem)}.container{padding:0 20px;max-width:100%;margin:0 auto}@media only screen and (min-width:36em){.container{max-width:540px;margin:0 auto}}@media only screen and (min-width:48em){.container{max-width:720px;margin:0 auto}}@media only screen and (min-width:62em){.container{max-width:960px;margin:0 auto}}@media only screen and (min-width:75em){.container{max-width:1170px;margin:0 auto}}.header{background-color:#fff;color:#343851;position:absolute;z-index:4;width:100%;top:0;left:0;will-change:transform;-webkit-transform:translateY(0);transform:translateY(0)}.header a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-bottom:0}.header__logo{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;overflow:hidden;padding:19px 0;margin-right:1.25rem;outline:0;border-bottom:0;color:#313237}.header__logo .header__logo--container{width:58px}.header__logo .header__logo--container .logo{fill:currentColor}.header__inner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:3.75em;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.header__links{padding-bottom:.5rem;display:none;position:absolute;top:3.75em;left:0;width:100%;height:auto;background:#fff}.header__link{color:#343851;padding:.938rem 0;border-top:1px solid #ededed}.header__toggle{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:44px;height:100%;background-color:transparent;padding-left:1.25rem}.header__toggle span{display:block;position:relative;margin-top:4px;background-color:#343851;width:100%;height:2px;border-radius:1px}.header__toggle span:first-child{margin-top:0}@media (min-width:62em){.header__toggle{display:none;visibility:hidden}.header__links{position:static;padding:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;visibility:visible;width:auto;height:100%}.header__links-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;padding:0}.header__link{position:relative;padding:.938rem 1rem;border:0;height:100%}.header__link::after{content:"";display:block;position:absolute;left:0;bottom:0;height:3px;width:100%;-webkit-transform:scaleX(0);transform:scaleX(0);background:#277cea}}.post-card{display:block;position:relative;width:100%;min-height:250px;border-radius:4px;overflow:hidden;background-color:#fff;-webkit-box-shadow:0 1px 3px rgba(0,0,0,.08);box-shadow:0 1px 3px rgba(0,0,0,.08);margin-bottom:2.25rem;border-bottom:0}@media only screen and (min-width:48em){.post-card{width:48.4375%;margin-right:3.125%}.post-card:nth-child(2n+2){margin-right:0}}@media only screen and (min-width:75em){.post-card{width:31.25%;margin-right:3.125%}.post-card:nth-child(2n+2){margin-right:3.125%}}.post-card__label{position:absolute;top:1.5rem;left:1.5rem;z-index:2}.post-card__inner{display:block;position:relative;padding:1.875rem 1.25rem .625rem;width:100%;color:#838c8d;border-bottom:0}.post-card__header{margin-bottom:.75rem}.post-card__meta{font-size:.875rem}.post-card__thumb{margin:0;background:#fff;position:relative;overflow:hidden}.post-card__thumb::after{content:"";display:block;height:0;width:100%;padding-bottom:56.25%}.post-card__thumb>*{position:absolute;top:0;left:0;width:100%;height:100%;display:block}.label{padding:0 10px;margin-bottom:1rem;display:inline-block;line-height:20px;font-size:.75rem;text-transform:uppercase;letter-spacing:1px;color:rgba(255,255,255,.8);border:2px solid rgba(255,255,255,.5);border-radius:100px}.hero{margin:3.75rem auto 0;min-height:16.25rem;width:100%;position:relative;background-color:#dde5ea;background-repeat:no-repeat;background-position:50%;background-size:cover}@media only screen and (min-width:62em){.hero{margin:0 auto;height:36em}}.hero::before{position:absolute;display:block;content:"";top:0;left:0;width:100%;height:100%;background:rgba(52,56,81,.8)}.hero__wrap{position:absolute;margin:auto;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);text-align:center;color:rgba(255,255,255,.8);width:100%;max-width:90%;z-index:1}.hero__wrap .hero__title{font-size:1.8em;color:#fff}.blog{background-color:#f9f9f9}.post-list{padding-top:2.5em;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}@media only screen and (min-width:48em){.hero__wrap{max-width:40em}.hero__wrap .hero__title{padding:1rem 0;font-size:2.625em;line-height:3.125rem}.post-list{padding-top:5em}}</style><link rel="preload" href="/assets/css/main.css" as="style" onload="this.rel='stylesheet'"> <noscript><link rel="stylesheet" href="/assets/css/main.css"></noscript> <script type="text/javascript"> /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */ (function(w){"use strict";if(!w.loadCSS){w.loadCSS=function(){}} var rp=loadCSS.relpreload={};rp.support=(function(){var ret;try{ret=w.document.createElement("link").relList.supports("preload")}catch(e){ret=!1} return function(){return ret}})();rp.bindMediaToggle=function(link){var finalMedia=link.media||"all";function enableStylesheet(){link.media=finalMedia} if(link.addEventListener){link.addEventListener("load",enableStylesheet)}else if(link.attachEvent){link.attachEvent("onload",enableStylesheet)} setTimeout(function(){link.rel="stylesheet";link.media="only x"});setTimeout(enableStylesheet,3000)};rp.poly=function(){if(rp.support()){return} var links=w.document.getElementsByTagName("link");for(var i=0;i<links.length;i++){var link=links[i];if(link.rel==="preload"&&link.getAttribute("as")==="style"&&!link.getAttribute("data-loadcss")){link.setAttribute("data-loadcss",!0);rp.bindMediaToggle(link)}}};if(!rp.support()){rp.poly();var run=w.setInterval(rp.poly,500);if(w.addEventListener){w.addEventListener("load",function(){rp.poly();w.clearInterval(run)})}else if(w.attachEvent){w.attachEvent("onload",function(){rp.poly();w.clearInterval(run)})}} if(typeof exports!=="undefined"){exports.loadCSS=loadCSS} else{w.loadCSS=loadCSS}}(typeof global!=="undefined"?global:this)) </script></head><body class="site"><header class="header" itemscope itemtype="http://schema.org/SiteNavigationElement" aria-label="Main navigation"><div class="container"><div class="header__inner"> <a class="header__logo" href="/"> <!--<div class="header__logo--container"> <?xml version="1.0" encoding="UTF-8" standalone="no"?> <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="260px" height="260px" viewBox="0 0 260 260" enable-background="new 0 0 260 260" xml:space="preserve"> <image id="image0" width="260" height="260" x="0" y="0" xlink:href="data:image/png;base64,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" /> </svg></div>--> </a><nav class="header__links"><div class="container header__links-wrapper"> <a class="header__link" href="/" itemprop="url"> <span itemprop="name">Home</span> </a> <a class="header__link" href="/about" itemprop="url"> <span itemprop="name">About</span> </a></div></nav><div class="header__toggle"> <span></span> <span></span> <span></span></div></div></div></header><div class="hero lazyload" data-bg="/assets/img/posts//20200719/linus-ekenstam-I1IrsPHEUpc-unsplash.jpg"><div class="hero__wrap"><div class="hero__categories"> <a class="label" href="/categories/#OpenSuse Kubic">OpenSuse Kubic</a> &nbsp; <a class="label" href="/categories/#Kubernetes">Kubernetes</a> &nbsp; <a class="label" href="/categories/#English">English</a></div><h1 class="hero__title">Single-node cluster Kubernetes with openSUSE Kubic and MetalLB</h1><p class="hero__meta"> <span> <time>19 Jul 2020</time>&nbsp;&middot; </span> <span> 6 mins read </span></p></div></div><main class="site__content"><div class="container"><article class="post-content" itemprop="articleBody"><h5 id="table-of-contents">Table of Contents</h5><p><a href="#Intro">Introduccion</a></p><p><a href="#Installation">Install OpenSuse Kubic</a></p><p><a href="#InitialKube">Initialize Kubernetes on the host</a></p><p><a href="#InitialLoadBalancer">Initialize bare metal load-balancer</a></p><hr /><p><a name="Intro"></a></p><h2 id="introduction">Introduction</h2><p>In this part we will concentrate on the installation of OpenSuse Kubic for a small home server <a href="https://www.intel.fr/content/www/fr/fr/products/boards-kits/nuc.html">intel NUC</a> with home router DHCP networks. Another interesting point is that there is an installer for Raspberry Pi, however we’ll leave it for another tutorial.</p><p>Containerisation technologies have been appears for years, but it wasn’t until Docker’s breakthrough that they began to reach a wider audience, thanks to the fact that one of the purposes of the solution is to facilitate the deployment of software containers. Since then, technologies have emerged that try to facilitate their management.</p><p>The containers, together with microservices and other forms of application delivery, have become a change that has been quite abrupt for many. In order to further facilitate the deployment process, the Kubic project take advantage of the best of these new concepts and bring them to openSUSE to provide the best support for these new technologies. These are the parts the developers are working on now:</p><ul><li>Transactional updates.</li><li>MicroOS.</li><li>Tumbleweed Kubic.</li><li>Alternative container execution environments (CRI-O, Podman).</li><li>Containers without root.</li></ul><p>For more information <a href="https://kubic.opensuse.org/">link</a></p><p><a name="Installation"></a></p><h2 id="install-opensuse-kubic">Install OpenSuse Kubic</h2><p>After downloading the last ISO from the Project OpenSuse Kubic, burn this media to a DVD or USB Stick, and then boot your first system from it.</p><p>let’s install the OS.</p><p><img src="/assets/img/posts/20200719/01-OpensuseKubic.png" alt="" title="step 1" /></p><p>Select your Keyboard Layout and License Agreement.</p><p><img src="/assets/img/posts/20200719/03-OpensuseKubic.png" alt="" title="step 2" /></p><p>Select the following “System Roles” in the select option “kubeadm Node”</p><p><img src="/assets/img/posts/20200719/04-OpensuseKubic.png" alt="" title="step 3" /></p><p>Enter your root password.</p><p><img src="/assets/img/posts/20200719/06-OpensuseKubic.png" alt="" title="step 4" /></p><p>In the installation setting, I can propose to activate also other option of Podman. It’s not mandatory and it’s just if you want to play like me with it. So, select the option “Software”</p><p><img src="/assets/img/posts/20200719/07-OpensuseKubic.png" alt="" title="step 7" /></p><p>And after select the option “Container Runtine for non-containers” and accept.</p><p><img src="/assets/img/posts/20200719/10-OpensuseKubic.png" alt="" title="step 8" /></p><p>To finish select install option and confirm.</p><p><img src="/assets/img/posts/20200719/12-OpensuseKubic.png" alt="" title="step 9" /></p><p>After the installation is finish and the os reboot, you can access with the root user.</p><p><img src="/assets/img/posts/20200719/14-OpensuseKubic.png" alt="" title="step 10" /></p><p><a name="InitialKube"></a></p><h2 id="initialize-kubernetes-on-the-host">Initialize Kubernetes on the host</h2><p>Login using the root password set during the installation.</p><h3 id="label-of-your-node-kubernetes">Label of your Node Kubernetes</h3><p>I can advise you to check your connection configuration for your hostname, because the one label of your Node Kubernetes will be taken from hostname.</p><p>So, to avoid to set your hostname via router DHCP and maintain a name you like.</p><pre><code class="language-no-highlight">vi /etc/sysconfig/network/dhcp
</code></pre><p>And verify if you have for IPv4 and IPv6.</p><pre><code class="language-no-highlight">DHCLIENT_SET_HOSTNAME="no"
</code></pre><p>Set your hostname by editing the file and reboot.</p><pre><code class="language-no-highlight">vi /etc/hosts
</code></pre><h3 id="dhcp-ip-reservation-for-node">DHCP IP reservation for Node</h3><p>It’s important to maintain the same IP for your server in the DHCP networks, as you can lost your access to kubernetes cluster node.</p><p>So check how you can set a reservation IP address for a device. When you use DHCP IP reservation, you’re telling your wi-fi to assign the same IP address to a specific device whenever that device connects to your network. Your are not configuring a static IP networks, it’s just on the DHCP networks you links the MAC device with hostname and particular IP.</p><h3 id="setting-up-kubernetes-master">Setting up Kubernetes master</h3><p>Activate your homeserver like master.</p><pre><code class="language-no-highlight">kubeadm init
</code></pre><p>Wait a little bit and your Master should now be initialised. Please take a note of the token line with kubeadm join.</p><h3 id="preliminary-kubernetes-setup">Preliminary kubernetes setup</h3><p>Configure the root user to be able to talk to the cluster by running.</p><pre><code class="language-no-highlight"> mkdir -p ~/.kube
 cp -i /etc/kubernetes/admin.conf ~/.kube/config
</code></pre><h3 id="setting-up-the-network-plugin">Setting up the network plugin</h3><p>According the OpenSuse Kubic help, there are three option but Weave is the recommended for most basic use cases.</p><p>Setup weave by running</p><pre><code class="language-no-highlight">kubectl apply -f /usr/share/k8s-yaml/weave/weave.yaml
</code></pre><h3 id="single-master-operation-and-allow-pods-to-run-on-the-master">Single Master Operation and allow Pods to run on the master</h3><p>The following command removes the limitation of running Pods on the master node.</p><pre><code class="language-no-highlight">kubectl taint nodes --all node-role.kubernetes.io/master-
</code></pre><p>You can run “kubectl get nodes -A” to confirm your cluster is operational.</p><p>Bravo! You now have a working Kubernetes cluster.</p><h3 id="kubectl-shell-autocompletion-for-bash">kubectl shell autocompletion for bash</h3><p>Active the shell command-line completion, this one allows you to quickly build your command without having to type every character.</p><p>Install the package.</p><pre><code class="language-no-highlight">transactional-update pkg in bash-completion
</code></pre><p>And add the kubectl completion bash.re</p><pre><code class="language-no-highlight">echo 'source &lt;(kubectl completion bash)' &gt;&gt;~/.bashrc
</code></pre><p><a name="InitialLoadBalancer"></a></p><h2 id="initialize-bare-metal-load-balancer">Initialize bare metal load-balancer</h2><p>MetalLB is a great load balancer for a home Kubernetes cluster. It allows you to assign real IPs from your home network to services running in your cluster and access them from other hosts on your home network.</p><p>Help for the site <a href="https://metallb.universe.tf/configuration/">Metalbl</a></p><p>Install the metallb-k8s-yaml package.</p><pre><code class="language-no-highlight">transactional-update pkg in metallb-k8s-yaml
</code></pre><p>Apply the components</p><pre><code class="language-no-highlight">kubectl apply -f /usr/share/k8s-yaml/metallb/namespace.yaml

kubectl apply -f /usr/share/k8s-yaml/metallb/metallb.yaml
</code></pre><p>After applying the manifests, create a random Kubernetes secret for the speakers to use for encrypted communications:</p><pre><code class="language-no-highlight">kubectl create secret generic -n metallb-system memberlist --from-literal=secretkey="$(openssl rand -base64 128)"
</code></pre><p>configure MetalLB and create a configMap that describes the pool of IP addresses the load balancer will use.</p><p>Configure the address pools</p><p>In my home network, IP addresses are assigned by the DHCP server my router is running. So with the a configMap we’ll define the details of the addresses it can assign to the Kubernetes Service LoadBalancers.</p><pre><code class="language-no-highlight">vi metallb-cf.yaml 
</code></pre><p>Put this parameter and change your ip range.</p><pre><code class="language-no-highlight">apiVersion: v1
kind: ConfigMap
metadata:
  namespace: metallb-system
  name: config
data:
  config: |
    address-pools:
    - name: default
      protocol: layer2
      addresses:
      - 192.168.2.50-192.168.2.70 &lt;= Select the range you want.
</code></pre><p>and apply it.</p><pre><code class="language-no-highlight">kubectl apply -f metallb-cf.yaml
</code></pre><h3 id="test-metallb">Test MetalLB</h3><p>You can test the new MetalLB configuration by creating an example web service. Good, there is the following option in Kubic to test it :) <a href="https://github.com/thkukuk/hello-kubic">hello-kubic</a>.</p><p>To deploy the service.</p><pre><code class="language-no-highlight">kubectl apply -f https://raw.githubusercontent.com/thkukuk/hello-kubic/master/yaml/hello-kubic.yaml
</code></pre><p>Check your external IP adress.</p><pre><code class="language-no-highlight">kubectl get svc
 NAME          TYPE           CLUSTER-IP     EXTERNAL-IP    PORT(S)        AGE
 hello-kubic   LoadBalancer   10.97.119.87   192.168.1.50   80:31473/TCP   6s
 kubernetes    ClusterIP      10.96.0.1      &lt;none&gt;         443/TCP        5d3h
</code></pre><p>Open your favorite browser and put the external IP.</p><p><img src="https://raw.githubusercontent.com/thkukuk/hello-kubic/master/images/Hello-Kubic-Screenshot.png" alt="" title="Hello-Kubic" /></p><hr /><p>Thank you for the initial photo.</p><p><span>Photo by <a href="https://unsplash.com/@linusekenstam?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Linus Ekenstam</a> on <a href="https://unsplash.com/s/photos/cube?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></span></p></article><div class="post-content controls__inner"><div class="controls__item prev"> <span>Previous</span> <a href="/IP-from-DHCP-podman/"> <span> <svg xmlns="http://www.w3.org/2000/svg" width="6" height="11"><path fill="fillColor" d="M5.647 1.718c.37-.434.323-1.09-.106-1.465A1.016 1.016 0 0 0 4.095.36L.25 4.875a1.05 1.05 0 0 0 .017 1.378l3.95 4.407c.38.424 1.03.456 1.448.07a1.05 1.05 0 0 0 .07-1.468l-3.34-3.725 3.253-3.819z"/> </svg> </span> Podman containers with IP a... </a></div><div class="controls__item next"> <span>Next</span> <a href="/cockpitWs-ssh-port-22/"> Cockpit-ws connection with ... <span> <svg xmlns="http://www.w3.org/2000/svg" width="6" height="11"><path fill="#fillColor" d="M.353 9.282c-.37.434-.323 1.09.106 1.465a1.016 1.016 0 0 0 1.446-.107L5.75 6.125a1.05 1.05 0 0 0-.017-1.378L1.784.34A1.015 1.015 0 0 0 .336.27a1.05 1.05 0 0 0-.07 1.468l3.34 3.725L.353 9.282z"/> </svg> </span> </a></div></div></div></main><footer class="footer"><div class="container"><nav class="social"></nav><span>&copy; 2024 XCO. All rights reserved.</span></div></footer><script async src="/assets/js/bundle.js"></script> <script async> if ('serviceWorker' in navigator) { navigator.serviceWorker.register('/sw.js').then(function( registration ) { console.log('ServiceWorker registration successful with scope: ', registration.scope); }) .catch(function(error) { console.log('ServiceWorker registration failed: ', error); }); } </script></body></html>
